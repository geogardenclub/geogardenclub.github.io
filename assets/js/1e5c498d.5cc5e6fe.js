"use strict";(self.webpackChunkgeogardenclub_github_io=self.webpackChunkgeogardenclub_github_io||[]).push([[1217],{798:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>c,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var n=i(5893),s=i(1151);const a={hide_table_of_contents:!1},r="Testing",o={id:"develop/testing",title:"Testing",description:"This page documents our current approach to testing the GeoGardenClub app.",source:"@site/docs/develop/testing.md",sourceDirName:"develop",slug:"/develop/testing",permalink:"/docs/develop/testing",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{hide_table_of_contents:!1},sidebar:"developSidebar",previous:{title:"Deployment",permalink:"/docs/develop/deployment"},next:{title:"Backups",permalink:"/docs/develop/backups"}},d={},l=[{value:"Run the tests",id:"run-the-tests",level:2},{value:"Always watch the iOS simulator!",id:"always-watch-the-ios-simulator",level:2},{value:"About app_test.dart",id:"about-app_testdart",level:2},{value:"About test_outcome.dart",id:"about-test_outcomedart",level:2},{value:"About run_tests_single.sh and app_test_single.dart",id:"about-run_tests_singlesh-and-app_test_singledart",level:2},{value:"Coverage",id:"coverage",level:2},{value:"Run the simulator with test data",id:"run-the-simulator-with-test-data",level:2},{value:"Continuous integration",id:"continuous-integration",level:2},{value:"Test fixture design",id:"test-fixture-design",level:2},{value:"Fixture Paths",id:"fixture-paths",level:3},{value:"AssetCollectionBuilder",id:"assetcollectionbuilder",level:3},{value:"TestFixture singleton",id:"testfixture-singleton",level:3}];function h(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"testing",children:"Testing"})}),"\n",(0,n.jsx)(t.p,{children:"This page documents our current approach to testing the GeoGardenClub app."}),"\n",(0,n.jsx)(t.h2,{id:"run-the-tests",children:"Run the tests"}),"\n",(0,n.jsxs)(t.p,{children:["To run the test suite, invoke ",(0,n.jsx)(t.code,{children:"./run_tests.sh"}),". It should produce output similar to the following:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:"~/GitHub/geogardenclub/ggc_app git:[issue-235]\n./run_tests.sh\n+ flutter test integration_test/app_test.dart --coverage\n00:15 +0: loading /Users/philipjohnson/GitHub/geogardenclub/ggc_app/integration_test/app_test.dart                              Ru00:41 +0: loading /Users/philipjohnson/GitHub/geogardenclub/ggc_app/integration_test/app_test.dart                               \n00:48 +0: loading /Users/philipjohnson/GitHub/geogardenclub/ggc_app/integration_test/app_test.dart                           6.6s\nXcode build done.                                           33.2s\n00:54 +0: GGC Integration Test (All) Fixture 1 Tests                                                                             \nTesting admin feature\nTesting badge feature\nTesting chapter feature\nTesting chat feature\nTesting crop feature\nTesting garden feature\nTesting gardener feature\nTesting geobot feature\nTesting home feature\nTesting observation feature\nTesting outcome feature\nTesting planting feature\nTesting settings feature\nTesting task feature\nTesting variety feature\n02:00 +1: All tests passed!                                                                                                      \n+ genhtml -q coverage/lcov.info -o coverage/html\nOverall coverage rate:\n  source files: 472\n  lines.......: 35.0% (4464 of 12740 lines)\n  functions...: no data found\nMessage summary:\n  no messages were reported\n"})}),"\n",(0,n.jsx)(t.p,{children:"Here are some important takeaways:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:'We only write integration tests; no unit or widget tests. This is to maximize our "return on investment": we want to implement and maintain the least amount of testing code possible while still catching as many bugs that we introduce from writing new code as we can.'}),"\n",(0,n.jsxs)(t.li,{children:['Our tests run with a specific "test fixture" (currently we\'re using one called Test Fixture 1). This is a sample dataset containing test values for most or all of the entities in our system (i.e. chapters, beds, gardens, gardeners, etc.).  This sample dataset is stored in ',(0,n.jsx)(t.code,{children:"assets/test/fixture1"}),".  In the future, we might write tests that require a different fixture."]}),"\n",(0,n.jsx)(t.li,{children:"Our test architecture is organized around features."}),"\n",(0,n.jsx)(t.li,{children:"We compute coverage as a simple check on the quality of the test set. We do not strive for 100% coverage, but we can clearly do better than (say) 35%.  In addition, the coverage report provides an efficient way to find important areas of the code base that have not yet been tested."}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"always-watch-the-ios-simulator",children:"Always watch the iOS simulator!"}),"\n",(0,n.jsxs)(t.admonition,{type:"warning",children:[(0,n.jsx)(t.mdxAdmonitionTitle,{}),(0,n.jsx)(t.p,{children:"If testing with the iOS simulator, the testing process will occasionally (and unpredictably) pause waiting for you to click on a button to allow pasting:"}),(0,n.jsx)("img",{src:"/img/develop/testing/core-simulator-bridge.png"}),(0,n.jsx)(t.p,{children:"For this reason, it's important to always watch the simulator at least until the tests start, because you might need to click a button to let the tests proceed."}),(0,n.jsx)(t.p,{children:"This is a security feature in the iOS operating system. I do not know of a way to disable it."})]}),"\n",(0,n.jsx)(t.h2,{id:"about-app_testdart",children:"About app_test.dart"}),"\n",(0,n.jsxs)(t.p,{children:["To further understand the test process, it's helpful to review the code that is run by the ",(0,n.jsx)(t.code,{children:"./run_tests.sh"})," command:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-dart",children:"// integration_test/app_test.dart\nvoid main() {\n  IntegrationTestWidgetsFlutterBinding.ensureInitialized();\n  group('GGC Integration Test (All)', () {\n    patrolWidgetTest('Fixture 1 Tests', (PatrolTester $) async {\n      await Firebase.initializeApp();\n      setFirebaseUiIsTestMode(true);\n      FirebaseAuth mockAuth = MockFirebaseAuth();\n      String email = 'jennacorindeane@gmail.com';\n      mockAuth.createUserWithEmailAndPassword(email: email, password: '');\n      TestFixture testFixture = await TestFixture.getInstance(testFixture1Path);\n      await $.pumpWidgetAndSettle(ProviderScope(\n        overrides: [\n          firebaseAuthProvider.overrideWithValue(mockAuth),\n          badgesProvider.overrideWith((_) => testFixture.getBadgesStream()),\n          badgeDatabaseProvider.overrideWith((_) => testFixture.getBadgeDatabase()),\n          badgeInstancesProvider.overrideWith((_) => testFixture.getBadgeInstancesStream()),\n          badgeInstanceDatabaseProvider.overrideWith((_) => testFixture.getBadgeInstanceDatabase()),\n          bedsProvider.overrideWith((_) => testFixture.getBedsStream()),\n          bedDatabaseProvider.overrideWith((ref) => testFixture.getBedDatabase()),\n          chaptersProvider.overrideWith((_) => testFixture.getChaptersStream()),\n          chapterDatabaseProvider.overrideWith((_) => testFixture.getChapterDatabase()),\n          chatRoomDatabaseProvider.overrideWith((_) => testFixture.getChatRoomDatabase()),\n          chatUserDatabaseProvider.overrideWith((_) => testFixture.getChatUserDatabase()),\n          cropsProvider.overrideWith((_) => testFixture.getCropsStream()),\n          cropDatabaseProvider.overrideWith((_) => testFixture.getCropDatabase()),\n          editorsProvider.overrideWith((_) => testFixture.getEditorsStream()),\n          editorDatabaseProvider.overrideWith((_) => testFixture.getEditorDatabase()),\n          familiesProvider.overrideWith((_) => testFixture.getFamiliesStream()),\n          familyDatabaseProvider.overrideWith((_) => testFixture.getFamilyDatabase()),\n          gardensProvider.overrideWith((_) => testFixture.getGardensStream()),\n          gardenDatabaseProvider.overrideWith((_) => testFixture.getGardenDatabase()),\n          gardenersProvider.overrideWith((_) => testFixture.getGardenersStream()),\n          gardenerDatabaseProvider.overrideWith((_) => testFixture.getGardenerDatabase()),\n          observationsProvider.overrideWith((_) => testFixture.getObservationsStream()),\n          observationDatabaseProvider.overrideWith((_) => testFixture.getObservationDatabase()),\n          outcomesProvider.overrideWith((_) => testFixture.getOutcomesStream()),\n          outcomeDatabaseProvider.overrideWith((_) => testFixture.getOutcomeDatabase()),\n          plantingsProvider.overrideWith((_) => testFixture.getPlantingsStream()),\n          plantingDatabaseProvider.overrideWith((_) => testFixture.getPlantingDatabase()),\n          rolesProvider.overrideWith((_) => testFixture.getRolesStream()),\n          roleDatabaseProvider.overrideWith((_) => testFixture.getRoleDatabase()),\n          tagsProvider.overrideWith((_) => testFixture.getTagsStream()),\n          tagDatabaseProvider.overrideWith((_) => testFixture.getTagDatabase()),\n          tasksProvider.overrideWith((_) => testFixture.getTasksStream()),\n          taskDatabaseProvider.overrideWith((_) => testFixture.getTaskDatabase()),\n          usersProvider.overrideWith((_) => testFixture.getUsersStream()),\n          userDatabaseProvider.overrideWith((_) => testFixture.getUserDatabase()),\n          varietiesProvider.overrideWith((_) => testFixture.getVarietiesStream()),\n          varietyDatabaseProvider.overrideWith((_) => testFixture.getVarietyDatabase()),\n        ],\n        child: const MyApp(),\n      ));\n      expect($(HomeScreen).visible, equals(true), reason: 'Login fails');\n      await checkIntegrity($, reason: 'startup');\n      await testAdmin($);\n      await checkIntegrity($, reason: 'admin feature');\n      await testBadge($);\n      await checkIntegrity($, reason: 'badge feature');\n      await testChapter($);\n      await checkIntegrity($, reason: 'chapter feature');\n      await testChat($);\n      await checkIntegrity($, reason: 'chat feature');\n      await testCrop($);\n      await checkIntegrity($, reason: 'crop feature');\n      await testGarden($);\n      await checkIntegrity($, reason: 'garden feature');\n      await testGardener($);\n      await checkIntegrity($, reason: 'gardener feature');\n      await testGeoBot($);\n      await checkIntegrity($, reason: 'geobot feature');\n      await testHome($);\n      await checkIntegrity($, reason: 'home feature');\n      await testObservation($);\n      await checkIntegrity($, reason: 'observation feature');\n      await testOutcome($);\n      await checkIntegrity($, reason: 'outcome feature');\n      await testPlanting($);\n      await checkIntegrity($, reason: 'planting feature');\n      await testSettings($);\n      await checkIntegrity($, reason: 'settings feature');\n      await testTask($);\n      await checkIntegrity($, reason: 'task feature');\n      await testVariety($);\n      await checkIntegrity($, reason: 'variety feature');\n    });\n  });\n}\n"})}),"\n",(0,n.jsx)(t.p,{children:"Here are the important takeaways:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["We use the ",(0,n.jsx)(t.a,{href:"https://patrol.leancode.co/finders/overview",children:"Patrol Finders"})," package, which provides a very helpful syntactic sugar over the built-in Flutter testing package. We do not use the full Patrol package, just their Patrol Finder package."]}),"\n",(0,n.jsx)(t.li,{children:"We use the Riverpod overrides feature so that during testing, our code manipulates the test fixture data rather than the data in the Firebase database."}),"\n",(0,n.jsxs)(t.li,{children:["We simulate Firebase authentication and the app starts up with the user ",(0,n.jsx)(t.a,{href:"mailto:jennacorindeane@gmail.com",children:"jennacorindeane@gmail.com"}),' already logged in. So, we don\'t currently test the registration or signin workflows. The app "starts" by displaying the Home screen for Jenna.']}),"\n",(0,n.jsx)(t.li,{children:'We test each feature by calling a "test" function (i.e. testChapter, testCrop, etc.).'}),"\n",(0,n.jsx)(t.li,{children:"After testing each feature, the code runs the Check Integrity admin function to ensure that the test of the previous feature did not introduce a database inconsistency."}),"\n",(0,n.jsxs)(t.li,{children:["You should rarely need to edit this ",(0,n.jsx)(t.code,{children:"app_test.dart"}),' file. Instead, you will usually edit one of the "test" feature files (i.e. testChapter.dart, testCrop.dart, etc.) You will normally need to edit this file only when you want to introduce the testing of a new feature.']}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"about-test_outcomedart",children:"About test_outcome.dart"}),"\n",(0,n.jsx)(t.p,{children:"Let's now look at one of the test functions for a specific feature:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-dart",children:"// integration_test/features/outcome/test_outcome.dart\nFuture<void> testOutcome(PatrolTester $) async {\n  // ignore: avoid_print\n  print('Testing outcome feature');\n  await gotoDrawerScreen($, GardenIndexScreen, 'Gardens');\n  expect($(GardenIndexScreen).visible, equals(true));\n  await $('Details').tap();\n  expect($(GardenDetailsScreen).visible, equals(true));\n  await $(BottomNavigationBar).$('Outcomes').tap();\n  expect($(GardenDetailsOutcomesView).visible, equals(true));\n  await $(BackButton).tap();\n}\n"})}),"\n",(0,n.jsx)(t.p,{children:"Here are some important takeaways:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Each test function starts by printing a line of output indicating that the test of this feature is starting. That makes it easier to see how far testing has gotten and helps pinpoint the location of problems when testing fails."}),"\n",(0,n.jsxs)(t.li,{children:["We use Patrol Finder syntax to locate widgets and manipulate them through searching for widgets of a particular type and/or containing a particular text string. ",(0,n.jsx)(t.em,{children:"Please avoid creating Keys for testing."}),"  Patrol Finders make it possible to test the source code without introducing new lines of code purely for the purpose of test support."]}),"\n",(0,n.jsx)(t.li,{children:"Currently, features are not tested very well at all, as this code shows. You will do most of your test development by editing these feature-level test files. You should feel free to refactor them and perhaps create new test files within the feature directory if useful."}),"\n",(0,n.jsxs)(t.li,{children:["The final line of code is ",(0,n.jsx)(t.code,{children:"await $(BackButton).tap();"}),". This is because each feature tests expects the system to be in a state where the Drawer menu icon is available to be tapped on. The feature tests do not require a specific screen to be displayed, any screen in which the Drawer menu icon is displayed is good enough."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"about-run_tests_singlesh-and-app_test_singledart",children:"About run_tests_single.sh and app_test_single.dart"}),"\n",(0,n.jsx)(t.p,{children:"While developing the test for a feature, it is humbug and time-consuming to have to run the entire test suite each time you want to run your newly developed test code."}),"\n",(0,n.jsxs)(t.p,{children:["To speed up testing, you can use the command ",(0,n.jsx)(t.code,{children:"./run_tests_single.sh"}),".  This runs the ",(0,n.jsx)(t.code,{children:"app_test_single.dart"})," file, which looks similar to this:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-dart",children:"// integration_test/app_test_single.dart\nvoid main() {\n  IntegrationTestWidgetsFlutterBinding.ensureInitialized();\n  group('GGC Integration Test (Single)', () {\n    patrolWidgetTest('Fixture 1 Tests', (PatrolTester $) async {\n      await Firebase.initializeApp();\n      setFirebaseUiIsTestMode(true);\n      FirebaseAuth mockAuth = MockFirebaseAuth();\n      String email = 'jennacorindeane@gmail.com';\n      mockAuth.createUserWithEmailAndPassword(email: email, password: '');\n      TestFixture testFixture = await TestFixture.getInstance(testFixture1Path);\n      await $.pumpWidgetAndSettle(ProviderScope(\n        overrides: [\n          firebaseAuthProvider.overrideWithValue(mockAuth),\n          badgesProvider.overrideWith((_) => testFixture.getBadgesStream()),\n          badgeDatabaseProvider.overrideWith((_) => testFixture.getBadgeDatabase()),\n          :\n          :\n          varietiesProvider.overrideWith((_) => testFixture.getVarietiesStream()),\n          varietyDatabaseProvider.overrideWith((_) => testFixture.getVarietyDatabase()),\n        ],\n        child: const MyApp(),\n      ));\n      expect($(HomeScreen).visible, equals(true), reason: 'Login fails');\n      await testChat($);\n    });\n  });\n}\n"})}),"\n",(0,n.jsx)(t.p,{children:"Here are some important takeaways:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"You can freely edit this file in your branch to focus on the specific feature of interest."}),"\n",(0,n.jsxs)(t.li,{children:['Sometimes you might want to check multiple features at once, that\'s fine. You do you. The idea is that this is a kind of "sandbox" for you to develop tests so that you are not wishing to edit the global ',(0,n.jsx)(t.code,{children:"./run_tests.sh"})," and ",(0,n.jsx)(t.code,{children:"app_test.dart"})," files to speed up testing."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"coverage",children:"Coverage"}),"\n",(0,n.jsxs)(t.p,{children:["It can sometimes be interesting to look at the coverage of testing. After running the test suite, you can open the file ",(0,n.jsx)(t.code,{children:"coverage/html/index.html"}),", which will look similar to this:"]}),"\n",(0,n.jsx)("img",{src:"/img/develop/testing/coverage.png"}),"\n",(0,n.jsx)(t.p,{children:"There are clickable links that you can use to drill down to see which statements have been executed and which have not been."}),"\n",(0,n.jsx)(t.p,{children:"Use coverage information wisely."}),"\n",(0,n.jsx)(t.h2,{id:"run-the-simulator-with-test-data",children:"Run the simulator with test data"}),"\n",(0,n.jsx)(t.p,{children:'During test design, it can be helpful to run the simulator with the test data loaded into it. That way you can "walk through" various behaviors and see what the system will do.'}),"\n",(0,n.jsxs)(t.p,{children:["To facilitate this, you can run ",(0,n.jsx)(t.code,{children:"lib/main_test_fixture.dart"})," using your IDE of choice.  This file is very similar to ",(0,n.jsx)(t.code,{children:"lib/main.dart"}),", except that it does the necessary Riverpod overrides so that the system will load the test fixture data and will login to the user ",(0,n.jsx)(t.a,{href:"mailto:jennacorindeane@gmail.com",children:"jennacorindeane@gmail.com"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"continuous-integration",children:"Continuous integration"}),"\n",(0,n.jsx)(t.p,{children:"It would be sweet to run the integration tests each time there is a commit to main."}),"\n",(0,n.jsx)(t.p,{children:"I'm working on it."}),"\n",(0,n.jsx)(t.h2,{id:"test-fixture-design",children:"Test fixture design"}),"\n",(0,n.jsxs)(t.p,{children:["We use JSON files to create the test data for the tests. The test files are located in one of (potentially many) directories named ",(0,n.jsx)(t.code,{children:"assets\\test\\fixtureN"}),', when "N" is a number uniquely identifying the fixture. Currently, we only have one fixture directory.']}),"\n",(0,n.jsx)(t.p,{children:"Each fixture directory must contain the following files:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"badgeData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"badgeInstanceData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"bedData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"chapterData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"cropData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"editorData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"familyData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"gardenData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"gardenerData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"observationData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"outcomeData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"plantingData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"roleData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"tagData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"taskData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"userData.json"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"varietyData.json"})}),"\n"]}),"\n",(0,n.jsxs)(t.admonition,{type:"info",children:[(0,n.jsx)(t.p,{children:"The JSON files need to have integrity, so their ids must align. Since many of the GGC IDs end with a four digit millis field we've assigned each type a unique millis field."}),(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"bedIDs end with 3456."}),"\n",(0,n.jsx)(t.li,{children:"cropIDs end with 5678."}),"\n",(0,n.jsx)(t.li,{children:"gardenIDs end with 7890."}),"\n",(0,n.jsx)(t.li,{children:"observationIDs end with 4567."}),"\n",(0,n.jsx)(t.li,{children:"outcomeIDs end with 2345."}),"\n",(0,n.jsx)(t.li,{children:"plantingIDs end with 1234."}),"\n",(0,n.jsx)(t.li,{children:"seedIDs end with 6789."}),"\n",(0,n.jsx)(t.li,{children:"taskIDs end with 8901."}),"\n",(0,n.jsx)(t.li,{children:"varietyIDs end with 9012."}),"\n",(0,n.jsx)(t.li,{children:"badgeInstances end with 9876."}),"\n"]})]}),"\n",(0,n.jsx)(t.h3,{id:"fixture-paths",children:"Fixture Paths"}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"lib/features/fixture_paths.dart"})," file defines two constants:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"testFixturePath"})," - the path to the test fixture directory. This constant is used to load the test data in the tests."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"monarchFixturePath"})," - the path to the Monarch fixture directory used by ",(0,n.jsx)(t.code,{children:"WithMonarchData"}),"."]}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"assetcollectionbuilder",children:"AssetCollectionBuilder"}),"\n",(0,n.jsxs)(t.p,{children:["To facilitate the loading of the fixture files, we have created the ",(0,n.jsx)(t.code,{children:"AssetCollectionBuilder"})," class. This class has three static methods to produce each of the collections from a fixture path. The three methods are as follows:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"Future<List<type>> getTypes(String assetPath)"})," - loads the data from the fixture file and returns a list of the type."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"Future<Stream<List<type>>> getTypesStream(String assetPath)"})," - loads the data from the fixture file and returns a stream of a list of the type."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"Future<TypeCollection> getTypeCollection(String assetPath)"})," - loads the data from the fixture file and returns a collection of the type."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["For example, to create a ",(0,n.jsx)(t.code,{children:"BedCollection"})," from the fixture path, use the following code:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"final bedCollection = await AssetCollectionBuilder.getBedCollection(testFixturePath);\n"})}),"\n",(0,n.jsxs)(t.p,{children:["In addition, the ",(0,n.jsx)(t.code,{children:"AssetCollectionBuilder"})," class has three build methods that build the collections with all the data like the ",(0,n.jsx)(t.code,{children:"WithAllData"})," classes. The methods are as follows"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"buildChapterCollection(String assetPath, String chapterId)"})," - builds a ",(0,n.jsx)(t.code,{children:"ChapterCollection"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"buildGardenCollection(String assetPath, String gardenId)"})," - builds a ",(0,n.jsx)(t.code,{children:"GardenCollection"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"buildUserCollection(String assetPath, String currentUserID, String currentUserUID)"})," - builds a ",(0,n.jsx)(t.code,{children:"UserCollection"}),"."]}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"testfixture-singleton",children:"TestFixture singleton"}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"TestFixture"})," singleton is used to load the test fixture data. The singleton has the following methods:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"getInstance(String assetPath)"})," - returns a Future with the singleton instance. The first time it is called, it will load the test fixture data."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"setup()"})," - initializes the singleton by loading the test fixture data."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"There are two methods for each entity in the test fixture:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"get<Entity>Stream()"})," - returns a Stream of the List of the entities from the test fixture."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"get<Entity>Database()"})," - returns The ",(0,n.jsx)(t.code,{children:"Fixture<Entity>Database"})," from the test fixture."]}),"\n"]})]})}function c(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},1151:(e,t,i)=>{i.d(t,{Z:()=>o,a:()=>r});var n=i(7294);const s={},a=n.createContext(s);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);