"use strict";(self.webpackChunkgeogardenclub_github_io=self.webpackChunkgeogardenclub_github_io||[]).push([[2318],{9495:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>p,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"develop/design/sort-by","title":"Sort By","description":"The Sort By design pattern provides a way to sort items by various fields in the different index screens (e.g., Badges, Chapters, Gardens, Gardeners, Crops, etc.)","source":"@site/docs/develop/design/sort-by.md","sourceDirName":"develop/design","slug":"/develop/design/sort-by","permalink":"/docs/develop/design/sort-by","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"hide_table_of_contents":false},"sidebar":"developSidebar","previous":{"title":"Collection classes","permalink":"/docs/develop/design/collection-classes"},"next":{"title":"Adaptive design","permalink":"/docs/develop/design/adaptive-design"}}');var o=t(4848),s=t(8453);const d={hide_table_of_contents:!1},a="Sort By",i={},l=[{value:"Design",id:"design",level:2},{value:"SortByType Enum",id:"sortbytype-enum",level:3},{value:"SortByDropdown Widget",id:"sortbydropdown-widget",level:3},{value:"Additional Methods for Collection Classes",id:"additional-methods-for-collection-classes",level:3},{value:"<code>getNumX</code>",id:"getnumx",level:4},{value:"<code>int Function (&lt;type&gt; a, &lt;type&gt; b) comparator(SortByType sortBy)</code>",id:"int-function-type-a-type-b-comparatorsortbytype-sortby",level:4},{value:"Usage",id:"usage",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"sort-by",children:"Sort By"})}),"\n",(0,o.jsx)(n.p,{children:"The Sort By design pattern provides a way to sort items by various fields in the different index screens (e.g., Badges, Chapters, Gardens, Gardeners, Crops, etc.)"}),"\n",(0,o.jsx)(n.h2,{id:"design",children:"Design"}),"\n",(0,o.jsx)(n.h3,{id:"sortbytype-enum",children:"SortByType Enum"}),"\n",(0,o.jsxs)(n.p,{children:["We've created a SortByType Enum with an extension for display names. Each index screen will use the appropriate values from this Enum to provide: sorting options. You can find the enum in ",(0,o.jsx)(n.code,{children:"features/common/widgets/sort_by_type.dart"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"enum SortByType {\n  name,\n  lastUpdate,\n  numBadges,\n  numCrops,\n  numGardens,\n  numGardeners,\n  numObservations,\n  numOutcomes,\n  numPostalCodes,\n  numTags,\n  numVarieties,\n  totalRetailValue,\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"sortbydropdown-widget",children:"SortByDropdown Widget"}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"SortByDropdown"})," widget is a reusable component that displays a dropdown menu for selecting the sort order. It takes the following parameters:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"choices"}),": A list of ",(0,o.jsx)(n.code,{children:"String"})," representing the ",(0,o.jsx)(n.code,{children:"SortByType"})," options available for sorting."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"selectedChoice"}),": The currently selected ",(0,o.jsx)(n.code,{children:"SortByType"})," as a String."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"onChanged"}),": A callback function that is invoked when the user selects a different sort option."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["You can find the ",(0,o.jsx)(n.code,{children:"SortByDropdown"})," widget in ",(0,o.jsx)(n.code,{children:"features/common/input-fields/sort_by_dropdown.dart"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"additional-methods-for-collection-classes",children:"Additional Methods for Collection Classes"}),"\n",(0,o.jsx)(n.h4,{id:"getnumx",children:(0,o.jsx)(n.code,{children:"getNumX"})}),"\n",(0,o.jsxs)(n.p,{children:["For each collection class (e.g., BadgeCollection, CropCollection, GardenCollection, etc.), we've added methods to get the number of related items. Each of these methods take a ",(0,o.jsx)(n.code,{children:"String id"}),", a ",(0,o.jsx)(n.code,{children:"String? caller"}),", and ",(0,o.jsx)(n.code,{children:"bool logp"})," that defaults to false."]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"id"}),": The identifier for the item whose related count is being queried. This is typically a gardenID, gardenerID, chapterID, etc."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"caller"}),": An optional parameter that can be used for logging or debugging purposes to indicate who is calling the method."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"logp"}),": A boolean flag that indicates whether to log the operation. It defaults to false."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["For example, in ",(0,o.jsx)(n.code,{children:"CropCollection"}),", we have:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"  int getNumCrops({\n    required String id,\n    String? caller,\n    bool logp = false,\n  }) {\n  List<String> cropIDs = [];\n  if (gardens.isGardenID(id)) {\n    cropIDs = gardens.getCropIDs(id);\n  } else if (gardens.gardeners.isGardenerID(id)) {\n    cropIDs = gardens.gardeners.getCropIDs(id);\n  } else if (chapters.isChapterID(id)) {\n    cropIDs = chapters.getCropIDs(id);\n  }\n  if (logp) {\n    (caller == null)\n        ? logger.w('getNumCrops id=$id num=${cropIDs.length}')\n        : logger.w('$caller: getNumCrops id=$id num=${cropIDs.length}');\n  }\n  return cropIDs.length;\n}\n"})}),"\n",(0,o.jsx)(n.h4,{id:"int-function-type-a-type-b-comparatorsortbytype-sortby",children:(0,o.jsx)(n.code,{children:"int Function (<type> a, <type> b) comparator(SortByType sortBy)"})}),"\n",(0,o.jsxs)(n.p,{children:["For each collection class, we've added a ",(0,o.jsx)(n.code,{children:"comparator"})," method that returns a comparison function based on the selected ",(0,o.jsx)(n.code,{children:"SortByType"}),". This function can be used to sort items in the collection according to the specified criteria. For example, in ",(0,o.jsx)(n.code,{children:"CropCollection"}),", we have:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"  int Function(Crop, Crop) comparator(SortByType sortBy) {\n  return switch (sortBy) {\n    SortByType.name => (Crop a, Crop b) => a.name.compareTo(b.name),\n    SortByType.lastUpdate => (a, b) =>\n        b.lastUpdate.compareTo(a.lastUpdate), // descending\n    SortByType.numGardens => (Crop a, Crop b) {\n      final int bGardens = gardens.getNumGardens(\n        id: b.cropID,\n        caller: 'CropCollection.comparator',\n        // logp: true,\n      );\n      final int aGardens = gardens.getNumGardens(\n        id: a.cropID,\n        caller: 'CropCollection.comparator',\n        // logp: true,\n      );\n      // logger.w(\n      //   'comparator: a=${a.name}($aGardens) '\n      //   'b=${b.name}($bGardens) comp= ${bGardens.compareTo(aGardens)}',\n      // );\n      return bGardens.compareTo(aGardens);\n    },\n    ... // Other cases that are implemented similarly\n    // For unimplemented cases, return 0\n    SortByType.lastUpdate ||\n    SortByType.numBadges ||\n    SortByType.numCrops ||\n    SortByType.numPostalCodes ||\n    SortByType.numTags => (Crop a, Crop b) => 0,\n    \n  }\n"})}),"\n",(0,o.jsx)(n.p,{children:"A few notes about the comparator method:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["We use a ",(0,o.jsx)(n.code,{children:"switch"})," expression to return the appropriate comparison function based on the ",(0,o.jsx)(n.code,{children:"sortBy"})," parameter."]}),"\n",(0,o.jsxs)(n.li,{children:["We don't provide a default option in the switch, so that the Dart analyzer will warn us if we forget to handle any ",(0,o.jsx)(n.code,{children:"SortByType"})," values. We use the ",(0,o.jsx)(n.code,{children:"||"})," operator to group multiple ",(0,o.jsx)(n.code,{children:"SortByType"})," values that should return the same comparison function."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,o.jsxs)(n.p,{children:["The index screens (e.g., Badges, Chapters, Gardens, Gardeners, Crops, etc.) will use the ",(0,o.jsx)(n.code,{children:"SortByDropdown"})," widget to allow users to select their preferred sort order (If we are displaying more than one item). The selected ",(0,o.jsx)(n.code,{children:"SortByType"})," will then be passed to the corresponding collection's ",(0,o.jsx)(n.code,{children:"comparator"})," method to return the correct comparator. Each of the screens are ",(0,o.jsx)(n.code,{children:"StatefulWidgets"}),", so when the user selects a different sort option, we call ",(0,o.jsx)(n.code,{children:"setState"})," to update the UI with the newly sorted items."]}),"\n",(0,o.jsxs)(n.p,{children:["For example, in the ",(0,o.jsx)(n.code,{children:"GardenIndexScreen"}),"'s ",(0,o.jsx)(n.code,{children:"build"})," method, we set up the ",(0,o.jsx)(n.code,{children:"SortByDropdown"})," choices and default ",(0,o.jsx)(n.code,{children:"_selectedSortBy"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"  String _selectedSortBy = SortByType.name.name;\n  List<String> sortByOptions = [\n    SortByType.name.name,\n    SortByType.lastUpdate.name,\n    SortByType.numBadges.name,\n    SortByType.numCrops.name,\n    SortByType.numGardeners.name,\n    SortByType.numObservations.name,\n    SortByType.numOutcomes.name,\n    SortByType.numVarieties.name,\n    SortByType.totalRetailValue.name,\n  ];\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Then we get the list of ",(0,o.jsx)(n.code,{children:"Gardens"})," to display and sort them."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"final List<Garden> gardensToDisplay =\n        ((selectedGardenID == 'All') || (selectedGardenID == ''))\n              ? widget.gardens.getAllGardens()\n              : [widget.gardens.getGarden(selectedGardenID)]\n          ..sort(\n            widget.gardens.comparator(\n              getSortByType(_selectedSortBy),\n            ),\n          );\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Not we are getting the comparator from the ",(0,o.jsx)(n.code,{children:"GardenCollection"})," and passing in the selected ",(0,o.jsx)(n.code,{children:"SortByType"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["Finally, we include the ",(0,o.jsx)(n.code,{children:"SortByDropdown"})," widget in the UI."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"if (gardensToDisplay.length > 1)\n  Padding(\n    padding: const EdgeInsets.only(left: 10, right: 10),\n    child: SortByDropdown(\n      choices: sortByOptions,\n      selectedChoice: _selectedSortBy,\n      onChanged: (String? newValue) {\n        setState(() {\n          if (newValue != null) {\n            _selectedSortBy = newValue;\n          }\n        });\n      },\n    ),\n  ),\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>a});var r=t(6540);const o={},s=r.createContext(o);function d(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);