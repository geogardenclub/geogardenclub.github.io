"use strict";(self.webpackChunkgeogardenclub_github_io=self.webpackChunkgeogardenclub_github_io||[]).push([[4020],{7488:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"develop/design/retail-value","title":"Retail Value","description":"The Retail Value feature is designed to:","source":"@site/docs/develop/design/retail-value.md","sourceDirName":"develop/design","slug":"/develop/design/retail-value","permalink":"/docs/develop/design/retail-value","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"hide_table_of_contents":false},"sidebar":"developSidebar","previous":{"title":"Badges","permalink":"/docs/develop/design/badges"},"next":{"title":"Coding Standards","permalink":"/docs/develop/quality-assurance/coding-standards"}}');var i=a(4848),r=a(8453);const l={hide_table_of_contents:!1},s="Retail Value",o={},d=[{value:"Design",id:"design",level:2},{value:"Public datasets",id:"public-datasets",level:2}];function c(e){const t={a:"a",admonition:"admonition",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"retail-value",children:"Retail Value"})}),"\n",(0,i.jsx)(t.p,{children:"The Retail Value feature is designed to:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:'Provide gardeners with an estimate of their "return on investment" on their home garden activities.'}),"\n",(0,i.jsx)(t.li,{children:"Help identify economically productive crops, gardens, and chapters."}),"\n",(0,i.jsx)(t.li,{children:"Support a Leaderboard for friendly inter and intra Chapter rivalries."}),"\n",(0,i.jsx)(t.li,{children:"Provide a competitive advantage of GGC over other gardening apps."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Retail Value is implemented via:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:'An admin command that defines a "default" price for a given crop and calendar year which can be used by all Chapters in a given country.'}),"\n",(0,i.jsx)(t.li,{children:"An admin command that provides a chapter-local price for a crop which overrides the default value for that crop."}),"\n",(0,i.jsx)(t.li,{children:"An admin command to refresh (or initialize) all cached quantity data by processing all Plantings across all chapters and updating the Crop, Garden, and Chapter documents."}),"\n",(0,i.jsx)(t.li,{children:'The ability to denote a crop as "priceless", i.e. it is not available in stores.'}),"\n",(0,i.jsx)(t.li,{children:'"Rollups" of Planting data that provide aggregate retail value data at the Garden, Crop, and Chapter levels.'}),"\n"]}),"\n",(0,i.jsx)(t.admonition,{title:"Retail Value is only for Crops",type:"info",children:(0,i.jsx)(t.p,{children:"We only support retail value at the Crop (not Variety) level. It is not possible to specify different retail values for different varieties of a single crop. Currently, we believe that the additional complexity required to implement variety-level retail value does not offer enough payback."})}),"\n",(0,i.jsx)(t.p,{children:"All retail prices are calculated as either lbs or kgs in the country's currency."}),"\n",(0,i.jsx)(t.h2,{id:"design",children:"Design"}),"\n",(0,i.jsx)(t.p,{children:'The biggest design challenge is to provide a way to cache retail value data so that we can have "rollups" at the Garden, Crop, and Chapter levels.  Here is the approach:'}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:'The "countries" collection provides the countryCode, currencyCode, weightUnit, and list of states for a given country.  This collection is downloaded and cached in WithCoreData/WithAllData. The countryCode field is the primary key.'}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:'The "prices" collection provides access to retail value prices. Each price document has: (a) a priceID, (b) a country code,  (c) an (optional) chapterID, (d) a year, (e) a cropID, (f) a price, and (g) a boolean priceless.  A null chapterID field means this document represents the default value for that country, crop, and year. This collection is downloaded and cached in WithCoreData/WithAllData.'}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Recomputation of aggregate quantity values is triggered when a gardener creates, updates, or deletes a Planting. At that point:"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:'The Planting quantity field is used to recompute the current Garden\'s cached aggregate quantity per year for that crop. This is done by finding all (other) Plantings in that Garden for that Year and that Crop and adding up their quantity fields. This information is stored in a new field in the Garden document called "cachedCropQuantityMap".  It is an instance of CropQuantityMap.'}),"\n",(0,i.jsx)(t.li,{children:"Once we know the updated aggregate quantity for a Crop and year for the current Garden, we can iterate over all other Gardens to find the new aggregate quantities for that Crop and year to cache in the Chapter document. Chapter documents also have a field called cachedCropQuantityMap, containing a CropQuantityMap for the entire chapter."}),"\n",(0,i.jsx)(t.li,{children:"There is no need for cached crop quantity data in the Crop documents. Instead, Crop-level quantities for the current chapter can be computed using the Chapter's cachedCropQuantityMap."}),"\n"]}),"\n",(0,i.jsxs)(t.ol,{start:"4",children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"If a price document indicates that a Crop is priceless, then it appears in rollups with an aggregate quantity but otherwise does not contribute to total retail values across Crops."}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"UI features to display retail value data will combine the aggregate quantity values cached in the Garden, Crop, and Chapter documents with the applicable Price and Country documents to compute the retail value."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"public-datasets",children:"Public datasets"}),"\n",(0,i.jsx)(t.p,{children:"There are public datasets we can use to support the creation of Price documents for crops in the US. For example,"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://usda.library.cornell.edu/concern/publications/vq27zn46v?locale=en",children:"https://usda.library.cornell.edu/concern/publications/vq27zn46v?locale=en"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://ers.usda.gov/data-products/fruit-and-vegetable-prices",children:"https://ers.usda.gov/data-products/fruit-and-vegetable-prices"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://data.ers.usda.gov/reports.aspx?ID=4061#P423cbf13568a45fbbe22ffd387de2852_3_63iT0R0R0x1",children:"https://data.ers.usda.gov/reports.aspx?ID=4061#P423cbf13568a45fbbe22ffd387de2852_3_63iT0R0R0x1"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://growingfruit.org/t/2025-fruit-sales-pricing/68745",children:"https://growingfruit.org/t/2025-fruit-sales-pricing/68745"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://www.foodcoop.com/produce/",children:"https://www.foodcoop.com/produce/"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,t,a)=>{a.d(t,{R:()=>l,x:()=>s});var n=a(6540);const i={},r=n.createContext(i);function l(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);