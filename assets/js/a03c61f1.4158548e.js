"use strict";(self.webpackChunkgeogardenclub_github_io=self.webpackChunkgeogardenclub_github_io||[]).push([[9533],{551:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>l,frontMatter:()=>o,metadata:()=>r,toc:()=>h});var n=a(5893),i=a(1151);const o={hide_table_of_contents:!0},s="Database Integrity Checking",r={id:"develop/integrity-check",title:"Database Integrity Checking",description:"We use a Firebase database to store the data associated with GGC.  One of the many important quality assurance issues associated with managing Firebase data is to ascertain whether or not the database contents are in a consistent state. In other words, does the database exhibit database integrity?",source:"@site/docs/develop/integrity-check.md",sourceDirName:"develop",slug:"/develop/integrity-check",permalink:"/docs/develop/integrity-check",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{hide_table_of_contents:!0},sidebar:"developSidebar",previous:{title:"Testing",permalink:"/docs/develop/testing"},next:{title:"Technology Goals",permalink:"/docs/develop/releases/release-1.0/goals"}},d={},h=[{value:"Why is database integrity even a problem?",id:"why-is-database-integrity-even-a-problem",level:2},{value:"How we detect integrity or the lack thereof",id:"how-we-detect-integrity-or-the-lack-thereof",level:2}];function c(e){const t={h1:"h1",h2:"h2",header:"header",p:"p",...(0,i.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"database-integrity-checking",children:"Database Integrity Checking"})}),"\n",(0,n.jsx)(t.p,{children:"We use a Firebase database to store the data associated with GGC.  One of the many important quality assurance issues associated with managing Firebase data is to ascertain whether or not the database contents are in a consistent state. In other words, does the database exhibit database integrity?"}),"\n",(0,n.jsx)(t.h2,{id:"why-is-database-integrity-even-a-problem",children:"Why is database integrity even a problem?"}),"\n",(0,n.jsx)(t.p,{children:'For a variety of reasons (mostly performance related), the data in the Firebase database is not  normalized. For example, certain documents will have a field starting with "cached" that indicates the document is holding data that was "derived" from other entities in the database. This is done to reduce the amount of data downloaded to each client app, and thus improve scalability of the system. Unfortunately, it is up to the app code to make sure these cached fields contain valid data.'}),"\n",(0,n.jsx)(t.p,{children:'In addition, our database structure includes many "foreign keys". For example, each Variety document has a field called "cropID", which holds a string that should contain the ID of the Crop entity associated with this Variety document.  In a SQL database, foreign keys can be managed automatically and the database can ensure that (a) any field that should contain a foreign key contains a valid foreign key, and (b) if you delete an entity, then any references to that entity\'s key (as a foreign key in some other record) will be deleted or dealt with appropriately. Unfortunately, in our NoSQL database, it is up to the app code to make sure that foreign keys are managed appropriately.'}),"\n",(0,n.jsx)(t.h2,{id:"how-we-detect-integrity-or-the-lack-thereof",children:"How we detect integrity or the lack thereof"}),"\n",(0,n.jsx)(t.p,{children:'The presence of foreign keys and cached values that must be managed manually means, of course, that sometimes they aren\'t managed correctly because the code wasn\'t written right. To address this problem, we implemented an admin operation called "Integrity Check".  Associated with each entity in the system is an method that checks, to the best of our ability, the "integrity" of all documents of that type. The Integrity Check admin operation calls all of these individual integrity checks and reports if any violations are found. Here\'s the UI:'}),"\n",(0,n.jsx)("img",{width:"500px",src:"/img/develop/firestore/integrity-check.png"}),"\n",(0,n.jsx)(t.p,{children:"The good news is that if we implement the individual Integrity Check operations correctly (and that isn't very hard to do), then invoking this operation is pretty good at revealing whether the database is consistent with respect to foreign keys, caching, and any other properties of interest."}),"\n",(0,n.jsx)(t.p,{children:"The bad news is that we have to remember to invoke it.  At the current time, it suffices for an Admin  periodically invoke it to check on database integrity.  If the number of users starts to scale, we will need to create a cloud function so that integrity can be checked on a regular and frequent basis."})]})}function l(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},1151:(e,t,a)=>{a.d(t,{Z:()=>r,a:()=>s});var n=a(7294);const i={},o=n.createContext(i);function s(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);